<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>cosense3d.modules.plugin package &mdash; Cosense3D 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=af2ce170"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=4825356b"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="cosense3d.modules.projection package" href="cosense3d.modules.projection.html" />
    <link rel="prev" title="cosense3d.modules.necks package" href="cosense3d.modules.necks.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Cosense3D
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="md/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="md/prepare_data.html">Prepare Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="md/structure.html">The Structure of the framework</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">CoSense3D</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="cosense3d.agents.html">cosense3d.agents package</a></li>
<li class="toctree-l2"><a class="reference internal" href="cosense3d.dataset.html">cosense3d.dataset package</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="cosense3d.modules.html">cosense3d.modules package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="cosense3d.modules.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="cosense3d.modules.backbone2d.html">cosense3d.modules.backbone2d package</a></li>
<li class="toctree-l4"><a class="reference internal" href="cosense3d.modules.backbone3d.html">cosense3d.modules.backbone3d package</a></li>
<li class="toctree-l4"><a class="reference internal" href="cosense3d.modules.fusion.html">cosense3d.modules.fusion package</a></li>
<li class="toctree-l4"><a class="reference internal" href="cosense3d.modules.heads.html">cosense3d.modules.heads package</a></li>
<li class="toctree-l4"><a class="reference internal" href="cosense3d.modules.losses.html">cosense3d.modules.losses package</a></li>
<li class="toctree-l4"><a class="reference internal" href="cosense3d.modules.necks.html">cosense3d.modules.necks package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">cosense3d.modules.plugin package</a></li>
<li class="toctree-l4"><a class="reference internal" href="cosense3d.modules.projection.html">cosense3d.modules.projection package</a></li>
<li class="toctree-l4"><a class="reference internal" href="cosense3d.modules.utils.html">cosense3d.modules.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cosense3d.modules.html#module-cosense3d.modules">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cosense3d.utils.html">cosense3d.utils package</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Cosense3D</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">CoSense3D</a></li>
          <li class="breadcrumb-item"><a href="cosense3d.modules.html">cosense3d.modules package</a></li>
      <li class="breadcrumb-item active">cosense3d.modules.plugin package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/cosense3d.modules.plugin.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="cosense3d-modules-plugin-package">
<h1>cosense3d.modules.plugin package<a class="headerlink" href="#cosense3d-modules-plugin-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-cosense3d.modules.plugin.attn">
<span id="cosense3d-modules-plugin-attn-module"></span><h2>cosense3d.modules.plugin.attn module<a class="headerlink" href="#module-cosense3d.modules.plugin.attn" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.attn.NeighborhoodAttention">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.attn.</span></span><span class="sig-name descname"><span class="pre">NeighborhoodAttention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emb_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/attn.html#NeighborhoodAttention"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.attn.NeighborhoodAttention" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.attn.NeighborhoodAttention.coor_to_indices">
<span class="sig-name descname"><span class="pre">coor_to_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/attn.html#NeighborhoodAttention.coor_to_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.attn.NeighborhoodAttention.coor_to_indices" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.attn.NeighborhoodAttention.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref_pts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctr_coor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctr_feat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/attn.html#NeighborhoodAttention.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.attn.NeighborhoodAttention.forward" title="Permalink to this definition"></a></dt>
<dd><section id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Permalink to this heading"></a></h3>
<p>ref_pts LongTensor(Q, 3): 2d coordinates in metrics(batch_idx, x, y)
ctr_coor LongTensor(V, 3): 2d coordinates in indices (batch_idx, x, y)
ctr_feat FloatTensor(V, d): bev grid center point features</p>
</section>
<section id="returns">
<h3>Returns<a class="headerlink" href="#returns" title="Permalink to this heading"></a></h3>
<blockquote>
<div><p>out_features FloatTensor(Q, d): attended features</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.attn.NeighborhoodAttention.get_nbr_mapping">
<span class="sig-name descname"><span class="pre">get_nbr_mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_pos</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/attn.html#NeighborhoodAttention.get_nbr_mapping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.attn.NeighborhoodAttention.get_nbr_mapping" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.attn.NeighborhoodAttention.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.attn.NeighborhoodAttention.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.attn.ScaledDotProductAttention">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.attn.</span></span><span class="sig-name descname"><span class="pre">ScaledDotProductAttention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/attn.html#ScaledDotProductAttention"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.attn.ScaledDotProductAttention" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Scaled Dot-Product Attention proposed in “Attention Is All You Need”
Compute the dot products of the query with all keys, divide each by sqrt(dim),
and apply a softmax function to obtain the weights on the values</p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.attn.ScaledDotProductAttention.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/attn.html#ScaledDotProductAttention.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.attn.ScaledDotProductAttention.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> – (batch, q_len, d_model) tensor containing projection vector for decoder.</p></li>
<li><p><strong>key</strong> – (batch, k_len, d_model) tensor containing projection vector for encoder.</p></li>
<li><p><strong>value</strong> – (batch, v_len, d_model) tensor containing features of the encoded input sequence.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>context, attn
- <strong>context</strong>: tensor containing the context vector from attention mechanism.
- <strong>attn</strong>: tensor containing the attention (alignment) from the encoder outputs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.attn.ScaledDotProductAttention.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.attn.ScaledDotProductAttention.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-cosense3d.modules.plugin.bev_rpn">
<span id="cosense3d-modules-plugin-bev-rpn-module"></span><h2>cosense3d.modules.plugin.bev_rpn module<a class="headerlink" href="#module-cosense3d.modules.plugin.bev_rpn" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.bev_rpn.Conv2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.bev_rpn.</span></span><span class="sig-name descname"><span class="pre">Conv2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/bev_rpn.html#Conv2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.bev_rpn.Conv2d" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.bev_rpn.Conv2d.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/bev_rpn.html#Conv2d.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.bev_rpn.Conv2d.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.bev_rpn.Conv2d.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.bev_rpn.Conv2d.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.bev_rpn.CustomRPN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.bev_rpn.</span></span><span class="sig-name descname"><span class="pre">CustomRPN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strides</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[2,</span> <span class="pre">2,</span> <span class="pre">2]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">down_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/bev_rpn.html#CustomRPN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.bev_rpn.CustomRPN" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.bev_rpn.CustomRPN.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/bev_rpn.html#CustomRPN.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.bev_rpn.CustomRPN.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.bev_rpn.CustomRPN.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.bev_rpn.CustomRPN.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.bev_rpn.RPN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.bev_rpn.</span></span><span class="sig-name descname"><span class="pre">RPN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">anchor_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/bev_rpn.html#RPN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.bev_rpn.RPN" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.bev_rpn.RPN.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/bev_rpn.html#RPN.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.bev_rpn.RPN.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.bev_rpn.RPN.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.bev_rpn.RPN.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-cosense3d.modules.plugin.downsample_conv">
<span id="cosense3d-modules-plugin-downsample-conv-module"></span><h2>cosense3d.modules.plugin.downsample_conv module<a class="headerlink" href="#module-cosense3d.modules.plugin.downsample_conv" title="Permalink to this heading"></a></h2>
<p>Class used to downsample features by 3*3 conv</p>
<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.downsample_conv.DoubleConv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.downsample_conv.</span></span><span class="sig-name descname"><span class="pre">DoubleConv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/downsample_conv.html#DoubleConv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.downsample_conv.DoubleConv" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Double convoltuion</p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.downsample_conv.DoubleConv.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/downsample_conv.html#DoubleConv.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.downsample_conv.DoubleConv.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.downsample_conv.DoubleConv.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.downsample_conv.DoubleConv.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.downsample_conv.DownsampleConv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.downsample_conv.</span></span><span class="sig-name descname"><span class="pre">DownsampleConv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[256]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strides</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">paddings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/downsample_conv.html#DownsampleConv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.downsample_conv.DownsampleConv" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.downsample_conv.DownsampleConv.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/downsample_conv.html#DownsampleConv.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.downsample_conv.DownsampleConv.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.downsample_conv.DownsampleConv.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.downsample_conv.DownsampleConv.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-cosense3d.modules.plugin.flash_attn">
<span id="cosense3d-modules-plugin-flash-attn-module"></span><h2>cosense3d.modules.plugin.flash_attn module<a class="headerlink" href="#module-cosense3d.modules.plugin.flash_attn" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.flash_attn.FlashAttention">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.flash_attn.</span></span><span class="sig-name descname"><span class="pre">FlashAttention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">softmax_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_dropout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_attn_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">type</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/flash_attn.html#FlashAttention"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.flash_attn.FlashAttention" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Implement the scaled dot product attention with softmax.</p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.flash_attn.FlashAttention.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">causal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_padding_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/flash_attn.html#FlashAttention.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.flash_attn.FlashAttention.forward" title="Permalink to this definition"></a></dt>
<dd><p>Implements the multihead softmax attention.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> – The tensor containing the query. (B, T, H, D)</p></li>
<li><p><strong>kv</strong> – The tensor containing the key, and value. (B, S, 2, H, D)</p></li>
<li><p><strong>causal</strong> – </p></li>
<li><p><strong>key_padding_mask</strong> – a bool tensor of shape (B, S)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.flash_attn.FlashAttention.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.flash_attn.FlashAttention.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.flash_attn.FlashMHA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.flash_attn.</span></span><span class="sig-name descname"><span class="pre">FlashMHA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embed_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">causal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/flash_attn.html#FlashMHA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.flash_attn.FlashMHA" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.flash_attn.FlashMHA.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_padding_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/flash_attn.html#FlashMHA.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.flash_attn.FlashMHA.forward" title="Permalink to this definition"></a></dt>
<dd><p>x: (batch, seqlen, hidden_dim) (where hidden_dim = num heads * head dim)
key_padding_mask: bool tensor of shape (batch, seqlen)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.flash_attn.FlashMHA.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.flash_attn.FlashMHA.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.flash_attn.flash_attn_unpadded_kvpacked_test">
<span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.flash_attn.</span></span><span class="sig-name descname"><span class="pre">flash_attn_unpadded_kvpacked_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cu_seqlens_q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cu_seqlens_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_sq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_sk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">softmax_scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">causal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/flash_attn.html#flash_attn_unpadded_kvpacked_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.flash_attn.flash_attn_unpadded_kvpacked_test" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.flash_attn.index_first_axis">
<span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.flash_attn.</span></span><span class="sig-name descname"><span class="pre">index_first_axis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cosense3d.modules.plugin.flash_attn.index_first_axis" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-cosense3d.modules.plugin.fpn">
<span id="cosense3d-modules-plugin-fpn-module"></span><h2>cosense3d.modules.plugin.fpn module<a class="headerlink" href="#module-cosense3d.modules.plugin.fpn" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.fpn.FPN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.fpn.</span></span><span class="sig-name descname"><span class="pre">FPN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_outs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_extra_convs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relu_before_extra_convs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_norm_on_lateral</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'mode':</span> <span class="pre">'nearest'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'distribution':</span> <span class="pre">'uniform',</span> <span class="pre">'layer':</span> <span class="pre">'Conv2d',</span> <span class="pre">'type':</span> <span class="pre">'Xavier'}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/fpn.html#FPN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.fpn.FPN" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.fpn.FPN.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/fpn.html#FPN.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.fpn.FPN.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.fpn.FPN.init_weights">
<span class="sig-name descname"><span class="pre">init_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/fpn.html#FPN.init_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.fpn.FPN.init_weights" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.fpn.FPN.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.fpn.FPN.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-cosense3d.modules.plugin.gevbev_decoder">
<span id="cosense3d-modules-plugin-gevbev-decoder-module"></span><h2>cosense3d.modules.plugin.gevbev_decoder module<a class="headerlink" href="#module-cosense3d.modules.plugin.gevbev_decoder" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.gevbev_decoder.GevBEVDecoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.gevbev_decoder.</span></span><span class="sig-name descname"><span class="pre">GevBEVDecoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/gevbev_decoder.html#GevBEVDecoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.gevbev_decoder.GevBEVDecoder" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.gevbev_decoder.GevBEVDecoder.coor_to_indices">
<span class="sig-name descname"><span class="pre">coor_to_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/gevbev_decoder.html#GevBEVDecoder.coor_to_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.gevbev_decoder.GevBEVDecoder.coor_to_indices" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.gevbev_decoder.GevBEVDecoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref_pts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctr_coor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctr_reg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/gevbev_decoder.html#GevBEVDecoder.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.gevbev_decoder.GevBEVDecoder.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref_pts</strong> – LongTensor(Q, 3) 2d coordinates in metrics(batch_idx, x, y)</p></li>
<li><p><strong>ctr_coor</strong> – LongTensor(V, 3) 2d coordinates in indices (batch_idx, x, y)</p></li>
<li><p><strong>ctr_reg</strong> – FloatTensor(V, d) bev grid center point regression result</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>out_evidence FloatTensor(Q, d): attended features</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.gevbev_decoder.GevBEVDecoder.get_nbr_mapping">
<span class="sig-name descname"><span class="pre">get_nbr_mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_pos</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/gevbev_decoder.html#GevBEVDecoder.get_nbr_mapping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.gevbev_decoder.GevBEVDecoder.get_nbr_mapping" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.gevbev_decoder.GevBEVDecoder.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.gevbev_decoder.GevBEVDecoder.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-cosense3d.modules.plugin.mink_spconv">
<span id="cosense3d-modules-plugin-mink-spconv-module"></span><h2>cosense3d.modules.plugin.mink_spconv module<a class="headerlink" href="#module-cosense3d.modules.plugin.mink_spconv" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.mink_spconv.Spconv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.mink_spconv.</span></span><span class="sig-name descname"><span class="pre">Spconv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/mink_spconv.html#Spconv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.mink_spconv.Spconv" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.mink_spconv.Spconv.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stensor_dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/mink_spconv.html#Spconv.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.mink_spconv.Spconv.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.mink_spconv.Spconv.get_2d_stensor">
<span class="sig-name descname"><span class="pre">get_2d_stensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stensor_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/mink_spconv.html#Spconv.get_2d_stensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.mink_spconv.Spconv.get_2d_stensor" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.mink_spconv.Spconv.get_conv_layer">
<span class="sig-name descname"><span class="pre">get_conv_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/mink_spconv.html#Spconv.get_conv_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.mink_spconv.Spconv.get_conv_layer" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.mink_spconv.Spconv.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.mink_spconv.Spconv.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-cosense3d.modules.plugin.naive_compressor">
<span id="cosense3d-modules-plugin-naive-compressor-module"></span><h2>cosense3d.modules.plugin.naive_compressor module<a class="headerlink" href="#module-cosense3d.modules.plugin.naive_compressor" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.naive_compressor.NaiveCompressor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.naive_compressor.</span></span><span class="sig-name descname"><span class="pre">NaiveCompressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compress_ratio</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/naive_compressor.html#NaiveCompressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.naive_compressor.NaiveCompressor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A very naive compression that only compress on the channel.</p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.naive_compressor.NaiveCompressor.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/naive_compressor.html#NaiveCompressor.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.naive_compressor.NaiveCompressor.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.naive_compressor.NaiveCompressor.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.naive_compressor.NaiveCompressor.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-cosense3d.modules.plugin.pillar_encoder">
<span id="cosense3d-modules-plugin-pillar-encoder-module"></span><h2>cosense3d.modules.plugin.pillar_encoder module<a class="headerlink" href="#module-cosense3d.modules.plugin.pillar_encoder" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.pillar_encoder.PFNLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.pillar_encoder.</span></span><span class="sig-name descname"><span class="pre">PFNLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/pillar_encoder.html#PFNLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.pillar_encoder.PFNLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.pillar_encoder.PFNLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/pillar_encoder.html#PFNLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.pillar_encoder.PFNLayer.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.pillar_encoder.PFNLayer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.pillar_encoder.PFNLayer.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.pillar_encoder.PillarEncoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.pillar_encoder.</span></span><span class="sig-name descname"><span class="pre">PillarEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lidar_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/pillar_encoder.html#PillarEncoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.pillar_encoder.PillarEncoder" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py property">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.pillar_encoder.PillarEncoder.absolute_xyz_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">absolute_xyz_dim</span></span><a class="headerlink" href="#cosense3d.modules.plugin.pillar_encoder.PillarEncoder.absolute_xyz_dim" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.pillar_encoder.PillarEncoder.compose_voxel_feature">
<span class="sig-name descname"><span class="pre">compose_voxel_feature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voxel_features</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/pillar_encoder.html#PillarEncoder.compose_voxel_feature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.pillar_encoder.PillarEncoder.compose_voxel_feature" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.pillar_encoder.PillarEncoder.distance_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">distance_dim</span></span><a class="headerlink" href="#cosense3d.modules.plugin.pillar_encoder.PillarEncoder.distance_dim" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.pillar_encoder.PillarEncoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voxel_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_num_points</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/pillar_encoder.html#PillarEncoder.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.pillar_encoder.PillarEncoder.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.pillar_encoder.PillarEncoder.get_paddings_indicator">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_paddings_indicator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actual_num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/pillar_encoder.html#PillarEncoder.get_paddings_indicator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.pillar_encoder.PillarEncoder.get_paddings_indicator" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.pillar_encoder.PillarEncoder.intensity_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">intensity_dim</span></span><a class="headerlink" href="#cosense3d.modules.plugin.pillar_encoder.PillarEncoder.intensity_dim" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.pillar_encoder.PillarEncoder.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.pillar_encoder.PillarEncoder.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.pillar_encoder.PillarEncoder.xyz_dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xyz_dim</span></span><a class="headerlink" href="#cosense3d.modules.plugin.pillar_encoder.PillarEncoder.xyz_dim" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-cosense3d.modules.plugin.ssfa">
<span id="cosense3d-modules-plugin-ssfa-module"></span><h2>cosense3d.modules.plugin.ssfa module<a class="headerlink" href="#module-cosense3d.modules.plugin.ssfa" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.ssfa.SSFA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.ssfa.</span></span><span class="sig-name descname"><span class="pre">SSFA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shrink_strides</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shrink_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/ssfa.html#SSFA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.ssfa.SSFA" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.ssfa.SSFA.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/ssfa.html#SSFA.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.ssfa.SSFA.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.ssfa.SSFA.init_weights">
<span class="sig-name descname"><span class="pre">init_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/ssfa.html#SSFA.init_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.ssfa.SSFA.init_weights" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.ssfa.SSFA.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.ssfa.SSFA.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.ssfa.get_conv_layers">
<span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.ssfa.</span></span><span class="sig-name descname"><span class="pre">get_conv_layers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conv_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relu_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequential</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/ssfa.html#get_conv_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.ssfa.get_conv_layers" title="Permalink to this definition"></a></dt>
<dd><p>Build convolutional layers. kernel_size, stride and padding should be a list with the lengths that match n_layers</p>
</dd></dl>

</section>
<section id="module-cosense3d.modules.plugin.target_assigners">
<span id="cosense3d-modules-plugin-target-assigners-module"></span><h2>cosense3d.modules.plugin.target_assigners module<a class="headerlink" href="#module-cosense3d.modules.plugin.target_assigners" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BEVBoxAssigner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.target_assigners.</span></span><span class="sig-name descname"><span class="pre">BEVBoxAssigner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_neg_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mining_thr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_mining_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mining_start_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">merge_all_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BEVBoxAssigner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BEVBoxAssigner" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#cosense3d.modules.plugin.target_assigners.BaseAssigner" title="cosense3d.modules.plugin.target_assigners.BaseAssigner"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseAssigner</span></code></a></p>
<p>Assign center points in the BEV maps to positve if the point is in the range ‘min_radius’ of any gt box center.</p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BEVBoxAssigner.assign">
<span class="sig-name descname"><span class="pre">assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">centers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_boxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BEVBoxAssigner.assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BEVBoxAssigner.assign" title="Permalink to this definition"></a></dt>
<dd><p>Assign preds to targets.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BEVBoxAssigner.get_labels_single_head">
<span class="sig-name descname"><span class="pre">get_labels_single_head</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">centers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_boxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BEVBoxAssigner.get_labels_single_head"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BEVBoxAssigner.get_labels_single_head" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BEVCenternessAssigner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.target_assigners.</span></span><span class="sig-name descname"><span class="pre">BEVCenternessAssigner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_neg_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mining_thr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_mining_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mining_start_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">merge_all_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_gaussian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BEVCenternessAssigner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BEVCenternessAssigner" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#cosense3d.modules.plugin.target_assigners.BaseAssigner" title="cosense3d.modules.plugin.target_assigners.BaseAssigner"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseAssigner</span></code></a></p>
<p>Assign center points in the BEV maps to positve if the point is in the range ‘min_radius’ of any gt box center.</p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BEVCenternessAssigner.assign">
<span class="sig-name descname"><span class="pre">assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">centers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_boxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BEVCenternessAssigner.assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BEVCenternessAssigner.assign" title="Permalink to this definition"></a></dt>
<dd><p>Assign preds to targets.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BEVCenternessAssigner.get_labels_single_head">
<span class="sig-name descname"><span class="pre">get_labels_single_head</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">centers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_boxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BEVCenternessAssigner.get_labels_single_head"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BEVCenternessAssigner.get_labels_single_head" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BEVPointAssigner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.target_assigners.</span></span><span class="sig-name descname"><span class="pre">BEVPointAssigner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">down_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_mining_thr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_mining_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annealing_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topk_sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annealing_sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BEVPointAssigner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BEVPointAssigner" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#cosense3d.modules.plugin.target_assigners.BaseAssigner" title="cosense3d.modules.plugin.target_assigners.BaseAssigner"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseAssigner</span></code></a></p>
<p>Assign target points to BEV boxes and down-sample the target points with buffered-based method.</p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BEVPointAssigner.assign">
<span class="sig-name descname"><span class="pre">assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tgt_pts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_boxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">down_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BEVPointAssigner.assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BEVPointAssigner.assign" title="Permalink to this definition"></a></dt>
<dd><p>Assign preds to targets.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BEVPointAssigner.downsample_tgt_pts">
<span class="sig-name descname"><span class="pre">downsample_tgt_pts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tgt_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_sam</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BEVPointAssigner.downsample_tgt_pts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BEVPointAssigner.downsample_tgt_pts" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BEVPointAssigner.get_predictions">
<span class="sig-name descname"><span class="pre">get_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BEVPointAssigner.get_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BEVPointAssigner.get_predictions" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BEVSemsegAssigner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.target_assigners.</span></span><span class="sig-name descname"><span class="pre">BEVSemsegAssigner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tgt_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">down_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annealing_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BEVSemsegAssigner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BEVSemsegAssigner" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#cosense3d.modules.plugin.target_assigners.BaseAssigner" title="cosense3d.modules.plugin.target_assigners.BaseAssigner"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseAssigner</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BEVSemsegAssigner.assign">
<span class="sig-name descname"><span class="pre">assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctr_pts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_boxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BEVSemsegAssigner.assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BEVSemsegAssigner.assign" title="Permalink to this definition"></a></dt>
<dd><p>Assign preds to targets.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BEVSemsegAssigner.down_sample_pred_pts">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">down_sample_pred_pts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctr_pts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BEVSemsegAssigner.down_sample_pred_pts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BEVSemsegAssigner.down_sample_pred_pts" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BEVSemsegAssigner.downsample_tgt_pts">
<span class="sig-name descname"><span class="pre">downsample_tgt_pts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tgt_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_sam</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BEVSemsegAssigner.downsample_tgt_pts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BEVSemsegAssigner.downsample_tgt_pts" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BEVSemsegAssigner.filter_range">
<span class="sig-name descname"><span class="pre">filter_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctr_pts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BEVSemsegAssigner.filter_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BEVSemsegAssigner.filter_range" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BEVSemsegAssigner.get_obs_mask">
<span class="sig-name descname"><span class="pre">get_obs_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BEVSemsegAssigner.get_obs_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BEVSemsegAssigner.get_obs_mask" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BEVSemsegAssigner.get_predictions">
<span class="sig-name descname"><span class="pre">get_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BEVSemsegAssigner.get_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BEVSemsegAssigner.get_predictions" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BEVSemsegAssigner.pts_to_inds">
<span class="sig-name descname"><span class="pre">pts_to_inds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BEVSemsegAssigner.pts_to_inds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BEVSemsegAssigner.pts_to_inds" title="Permalink to this definition"></a></dt>
<dd><p>Calculate indices of samples in the bev map</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BaseAssigner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.target_assigners.</span></span><span class="sig-name descname"><span class="pre">BaseAssigner</span></span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BaseAssigner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BaseAssigner" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base assigner.</p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BaseAssigner.assign">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BaseAssigner.assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BaseAssigner.assign" title="Permalink to this definition"></a></dt>
<dd><p>Assign preds to targets.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BoxAnchorAssigner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.target_assigners.</span></span><span class="sig-name descname"><span class="pre">BoxAnchorAssigner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">box_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dirs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lidar_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_coder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neg_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_thrshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BoxAnchorAssigner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BoxAnchorAssigner" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#cosense3d.modules.plugin.target_assigners.BaseAssigner" title="cosense3d.modules.plugin.target_assigners.BaseAssigner"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseAssigner</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BoxAnchorAssigner.assign">
<span class="sig-name descname"><span class="pre">assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gt_boxes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BoxAnchorAssigner.assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BoxAnchorAssigner.assign" title="Permalink to this definition"></a></dt>
<dd><section id="id1">
<h3>Parameters<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h3>
<p>gt_boxes Tensor(N, 7): [x, y, z, l, w, h, r, …]</p>
</section>
<section id="id2">
<h3>Returns<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h3>
<p>reg Tensor(H, W, num_anchors, code_size): box regression targets</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BoxAnchorAssigner.box_overlaps">
<span class="sig-name descname"><span class="pre">box_overlaps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">boxes1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxes2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BoxAnchorAssigner.box_overlaps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BoxAnchorAssigner.box_overlaps" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BoxAnchorAssigner.get_anchor_template">
<span class="sig-name descname"><span class="pre">get_anchor_template</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">box_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dirs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BoxAnchorAssigner.get_anchor_template"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BoxAnchorAssigner.get_anchor_template" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BoxAnchorAssigner.get_predictions">
<span class="sig-name descname"><span class="pre">get_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BoxAnchorAssigner.get_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BoxAnchorAssigner.get_predictions" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BoxAnchorAssigner.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BoxAnchorAssigner.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BoxCenterAssigner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.target_assigners.</span></span><span class="sig-name descname"><span class="pre">BoxCenterAssigner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voxel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lidar_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detection_benchmark</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_names_each_head</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_coder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BoxCenterAssigner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BoxCenterAssigner" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#cosense3d.modules.plugin.target_assigners.BaseAssigner" title="cosense3d.modules.plugin.target_assigners.BaseAssigner"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseAssigner</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BoxCenterAssigner.assign">
<span class="sig-name descname"><span class="pre">assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">centers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_boxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_preds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BoxCenterAssigner.assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BoxCenterAssigner.assign" title="Permalink to this definition"></a></dt>
<dd><p>Assign preds to targets.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BoxCenterAssigner.get_predictions">
<span class="sig-name descname"><span class="pre">get_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BoxCenterAssigner.get_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BoxCenterAssigner.get_predictions" title="Permalink to this definition"></a></dt>
<dd><p>Decode the center and regression maps into BBoxes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>preds</strong> – <ul class="simple">
<li><p>cls: list[Tensor], each tensor is the result from a cls head with shape (B or N, Ncls, …).</p></li>
<li><dl class="simple">
<dt>reg:</dt><dd><ul>
<li><p>box: list[Tensor], one tensor per reg head with shape (B or N, 6, …).</p></li>
<li><p>dir: list[Tensor], one tensor per reg head with shape (B or N, 8, …).</p></li>
<li><p>scr: list[Tensor], one tensor per reg head with shape (B or N, 4, …).</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>roi:
* box: list[Tensor], one tensor per head with shape (N, 8).
* scr: list[Tensor], one tensor per head with shape (N,).
* lbl: list[Tensor], one tensor per head with shape (N,).
* idx: list[Tensor], one tensor per head with shape (3, N), center map indices of the boxes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BoxCenterAssigner.pts_to_indices">
<span class="sig-name descname"><span class="pre">pts_to_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bev_pts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BoxCenterAssigner.pts_to_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BoxCenterAssigner.pts_to_indices" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>bev_pts</strong> – (N, 3+), BEV points, 1st column should be batch index.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BoxCenterAssigner.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BoxCenterAssigner.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BoxSparseAnchorAssigner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.target_assigners.</span></span><span class="sig-name descname"><span class="pre">BoxSparseAnchorAssigner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">box_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dirs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lidar_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_coder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">me_coor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neg_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_thrshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BoxSparseAnchorAssigner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BoxSparseAnchorAssigner" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#cosense3d.modules.plugin.target_assigners.BaseAssigner" title="cosense3d.modules.plugin.target_assigners.BaseAssigner"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseAssigner</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BoxSparseAnchorAssigner.assign">
<span class="sig-name descname"><span class="pre">assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_boxes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BoxSparseAnchorAssigner.assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BoxSparseAnchorAssigner.assign" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coors</strong> – (N, 2) 2D mink coor [x, y]</p></li>
<li><p><strong>gt_boxes</strong> – (M, 7) [x, y, z, l, w, h, r]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>labels Tensor(N, num_anchors): box regression targets</p></li>
<li><p>reg_tgt Tensor(N, num_anchors, code_size): box regression targets</p></li>
<li><p>ir_score Tensor(N, num_anchors, 4) or None: direction score target</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BoxSparseAnchorAssigner.box_overlaps">
<span class="sig-name descname"><span class="pre">box_overlaps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">boxes1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxes2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BoxSparseAnchorAssigner.box_overlaps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BoxSparseAnchorAssigner.box_overlaps" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BoxSparseAnchorAssigner.get_anchor_template">
<span class="sig-name descname"><span class="pre">get_anchor_template</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">box_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dirs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BoxSparseAnchorAssigner.get_anchor_template"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BoxSparseAnchorAssigner.get_anchor_template" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BoxSparseAnchorAssigner.get_predictions">
<span class="sig-name descname"><span class="pre">get_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BoxSparseAnchorAssigner.get_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BoxSparseAnchorAssigner.get_predictions" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coors</strong> – Tensor(N, 3) mink coor [batch_idx, x, y]</p></li>
<li><p><strong>preds</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BoxSparseAnchorAssigner.me_coor_to_grid_indices">
<span class="sig-name descname"><span class="pre">me_coor_to_grid_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#BoxSparseAnchorAssigner.me_coor_to_grid_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BoxSparseAnchorAssigner.me_coor_to_grid_indices" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.BoxSparseAnchorAssigner.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.BoxSparseAnchorAssigner.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.ContiBEVAssigner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.target_assigners.</span></span><span class="sig-name descname"><span class="pre">ContiBEVAssigner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distr_r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#ContiBEVAssigner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.ContiBEVAssigner" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#cosense3d.modules.plugin.target_assigners.BEVSemsegAssigner" title="cosense3d.modules.plugin.target_assigners.BEVSemsegAssigner"><code class="xref py py-class docutils literal notranslate"><span class="pre">BEVSemsegAssigner</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.ContiBEVAssigner.assign">
<span class="sig-name descname"><span class="pre">assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctr_pts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_boxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#ContiBEVAssigner.assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.ContiBEVAssigner.assign" title="Permalink to this definition"></a></dt>
<dd><p>Assign target.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctr_pts</strong> – center points of bev maps, including indices, metric centers and regression results.</p></li>
<li><p><strong>samples</strong> – BEV target point samples.</p></li>
<li><p><strong>B</strong> – batch size.</p></li>
<li><p><strong>gt_boxes</strong> – ground truth BBoxes.</p></li>
<li><p><strong>kwargs</strong> – keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>target_dict that contains the static or/and dynamic target points and their corresponding labels.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.ContiBEVAssigner.get_predictions">
<span class="sig-name descname"><span class="pre">get_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctr_pts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#ContiBEVAssigner.get_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.ContiBEVAssigner.get_predictions" title="Permalink to this definition"></a></dt>
<dd><p>Given center points and its corresponding regressions, generate the dense bev semseg maps
and its uncertainty and observation mask.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctr_pts</strong> – center points of bev maps, including indices, metric centers and regression results.</p></li>
<li><p><strong>B</strong> – batch size.</p></li>
<li><p><strong>tag</strong> – tag for regression key “static | dynamic”.</p></li>
<li><p><strong>kwargs</strong> – keyword arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>conf: confidence bev map.</p></li>
<li><p>unc: uncertainty bev map.</p></li>
<li><p>obs_mask: observation mask of the bev map.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.ContiBEVAssigner.sample_dynamic_tgt_pts">
<span class="sig-name descname"><span class="pre">sample_dynamic_tgt_pts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctr_pts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_boxes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#ContiBEVAssigner.sample_dynamic_tgt_pts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.ContiBEVAssigner.sample_dynamic_tgt_pts" title="Permalink to this definition"></a></dt>
<dd><p>Given the input coordinates of the center points and the ground truth BBoxes,
sample the BEV target points for BEV semantic segmentation following the buffer-based sampling as illustrated
in the following image:</p>
<a class="reference internal image-reference" href="_images/buffer_based_sampling.png"><img alt="Buffer-based sampling of the BEV target" src="_images/buffer_based_sampling.png" style="width: 400px;" /></a>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctr_pts</strong> – center points of bev maps, including indices, metric centers and regression results.</p></li>
<li><p><strong>gt_boxes</strong> – ground truth BBoxes.</p></li>
<li><p><strong>B</strong> – batch size.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>tgt_pts: sampled target points.</p></li>
<li><p>tgt_lbl: labels of the sampled target points.</p></li>
<li><p>inds: map indices of the sampled target points.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.DiscreteBEVAssigner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.target_assigners.</span></span><span class="sig-name descname"><span class="pre">DiscreteBEVAssigner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">down_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annealing_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#DiscreteBEVAssigner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.DiscreteBEVAssigner" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#cosense3d.modules.plugin.target_assigners.BaseAssigner" title="cosense3d.modules.plugin.target_assigners.BaseAssigner"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseAssigner</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.DiscreteBEVAssigner.assign">
<span class="sig-name descname"><span class="pre">assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctr_pts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_boxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#DiscreteBEVAssigner.assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.DiscreteBEVAssigner.assign" title="Permalink to this definition"></a></dt>
<dd><p>Assign preds to targets.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.DiscreteBEVAssigner.get_obs_mask">
<span class="sig-name descname"><span class="pre">get_obs_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#DiscreteBEVAssigner.get_obs_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.DiscreteBEVAssigner.get_obs_mask" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.DiscreteBEVAssigner.get_predictions">
<span class="sig-name descname"><span class="pre">get_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#DiscreteBEVAssigner.get_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.DiscreteBEVAssigner.get_predictions" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.DiscreteBEVAssigner.pts_to_inds">
<span class="sig-name descname"><span class="pre">pts_to_inds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#DiscreteBEVAssigner.pts_to_inds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.DiscreteBEVAssigner.pts_to_inds" title="Permalink to this definition"></a></dt>
<dd><p>Calculate indices of samples in the bev map</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.HeatmapAssigner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.target_assigners.</span></span><span class="sig-name descname"><span class="pre">HeatmapAssigner</span></span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#HeatmapAssigner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.HeatmapAssigner" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#cosense3d.modules.plugin.target_assigners.BaseAssigner" title="cosense3d.modules.plugin.target_assigners.BaseAssigner"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseAssigner</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.HeatmapAssigner.assign">
<span class="sig-name descname"><span class="pre">assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj_centers2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj_bboxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#HeatmapAssigner.assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.HeatmapAssigner.assign" title="Permalink to this definition"></a></dt>
<dd><p>Assign preds to targets.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.HeatmapAssigner.draw_heatmap_gaussian">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">draw_heatmap_gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">heatmap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#HeatmapAssigner.draw_heatmap_gaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.HeatmapAssigner.draw_heatmap_gaussian" title="Permalink to this definition"></a></dt>
<dd><p>Get gaussian masked heatmap.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>heatmap (torch.Tensor): Heatmap to be masked.
center (torch.Tensor): Center coord of the heatmap.
radius (int): Radius of gaussian.
k (int, optional): Multiple of masked_gaussian. Defaults to 1.</p>
</dd>
<dt>Returns:</dt><dd><p>torch.Tensor: Masked heatmap.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.HungarianAssigner2D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.target_assigners.</span></span><span class="sig-name descname"><span class="pre">HungarianAssigner2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls_cost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'type':</span> <span class="pre">'classification',</span> <span class="pre">'weight':</span> <span class="pre">1.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg_cost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'type':</span> <span class="pre">'bboxl1',</span> <span class="pre">'weight':</span> <span class="pre">1.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iou_cost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'type':</span> <span class="pre">'giou',</span> <span class="pre">'weight':</span> <span class="pre">1.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centers2d_cost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'type':</span> <span class="pre">'l1',</span> <span class="pre">'weight':</span> <span class="pre">1.0}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#HungarianAssigner2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.HungarianAssigner2D" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#cosense3d.modules.plugin.target_assigners.BaseAssigner" title="cosense3d.modules.plugin.target_assigners.BaseAssigner"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseAssigner</span></code></a></p>
<p>Computes one-to-one matching between predictions and ground truth.</p>
<p>This class computes an assignment between the targets and the predictions
based on the costs. The costs are weighted sum of three components:
classification cost, regression L1 cost, regression iou cost and center2d l1 cost.
The assignment is done in the following steps, the order matters.</p>
<ol class="arabic simple">
<li><p>assign every prediction to -1</p></li>
<li><p>compute the weighted costs</p></li>
<li><p>do Hungarian matching on CPU based on the costs</p></li>
<li><p>assign all to 0 (background) first, then for each matched pair
between predictions and gts, treat this prediction as foreground
and assign the corresponding gt index (plus 1) to it.</p></li>
</ol>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.HungarianAssigner2D.assign">
<span class="sig-name descname"><span class="pre">assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bbox_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cls_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_centers2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centers2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-07</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#HungarianAssigner2D.assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.HungarianAssigner2D.assign" title="Permalink to this definition"></a></dt>
<dd><p>Computes one-to-one matching based on the weighted costs.</p>
<p>This method assign each query prediction to a ground truth or
background. The <cite>assigned_gt_inds</cite> with -1 means don’t care,
0 means negative sample, and positive number is the index (1-based)
of assigned gt.
The assignment is done in the following steps, the order matters.</p>
<ol class="arabic simple">
<li><p>assign every prediction to -1</p></li>
<li><p>compute the weighted costs</p></li>
<li><p>do Hungarian matching on CPU based on the costs</p></li>
<li><p>assign all to 0 (background) first, then for each matched pair
between predictions and gts, treat this prediction as foreground
and assign the corresponding gt index (plus 1) to it.</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bbox_pred</strong> – Predicted boxes with normalized coordinates
(cx, cy, w, h), which are all in range [0, 1]. Shape
[num_query, 4].</p></li>
<li><p><strong>cls_pred</strong> – Predicted classification logits, shape
[num_query, num_class].</p></li>
<li><p><strong>pred_centers2d</strong> – prediction 2d center points.</p></li>
<li><p><strong>gt_bboxes</strong> – ground truth bboxes.</p></li>
<li><p><strong>gt_labels</strong> – Label of <cite>gt_bboxes</cite>, shape (num_gt,).
img_size: input image size.</p></li>
<li><p><strong>centers2d</strong> – 2d center points.</p></li>
<li><p><strong>img_size</strong> – input image size.</p></li>
<li><p><strong>eps</strong> – A value added to the denominator for
numerical stability. Default 1e-7.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.HungarianAssigner3D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.target_assigners.</span></span><span class="sig-name descname"><span class="pre">HungarianAssigner3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls_cost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'type':</span> <span class="pre">'focal_loss',</span> <span class="pre">'weight':</span> <span class="pre">1.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg_cost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'type':</span> <span class="pre">'l1',</span> <span class="pre">'weight':</span> <span class="pre">1.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iou_cost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'type':</span> <span class="pre">'iou',</span> <span class="pre">'weight':</span> <span class="pre">1.0}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#HungarianAssigner3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.HungarianAssigner3D" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#cosense3d.modules.plugin.target_assigners.BaseAssigner" title="cosense3d.modules.plugin.target_assigners.BaseAssigner"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseAssigner</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.HungarianAssigner3D.assign">
<span class="sig-name descname"><span class="pre">assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bbox_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cls_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">code_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-07</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#HungarianAssigner3D.assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.HungarianAssigner3D.assign" title="Permalink to this definition"></a></dt>
<dd><p>Assign preds to targets.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.MatchCost">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.target_assigners.</span></span><span class="sig-name descname"><span class="pre">MatchCost</span></span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#MatchCost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.MatchCost" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class is modified from mmdet.</p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.MatchCost.bboxl1">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bboxl1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bbox_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'xyxy'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#MatchCost.bboxl1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.MatchCost.bboxl1" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bbox_pred</strong> – Predicted boxes with normalized coordinates
(cx, cy, w, h), which are all in range [0, 1]. Shape
(num_query, 4).</p></li>
<li><p><strong>gt_bboxes</strong> – Ground truth boxes with normalized
coordinates (x1, y1, x2, y2). Shape (num_gt, 4).</p></li>
<li><p><strong>weight</strong> – loss_weight.</p></li>
<li><p><strong>box_format</strong> – ‘xyxy’ for DETR, ‘xywh’ for Sparse_RCNN.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>bbox_cost value with weight</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.MatchCost.binary_focal_loss">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">binary_focal_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#MatchCost.binary_focal_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.MatchCost.binary_focal_loss" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.MatchCost.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">type</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#MatchCost.build"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.MatchCost.build" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.MatchCost.classification">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">classification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#MatchCost.classification"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.MatchCost.classification" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls_pred</strong> – Predicted classification logits, shape
(num_query, num_class).</p></li>
<li><p><strong>gt_labels</strong> – Label of <cite>gt_bboxes</cite>, shape (num_gt,).</p></li>
<li><p><strong>weight</strong> – loss_weight.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>cls_cost value with weight</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.MatchCost.focal_loss">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">focal_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#MatchCost.focal_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.MatchCost.focal_loss" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.MatchCost.giou">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">giou</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bboxes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#MatchCost.giou"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.MatchCost.giou" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bboxes</strong> – Predicted boxes with unnormalized coordinates
(x1, y1, x2, y2). Shape (num_query, 4).</p></li>
<li><p><strong>gt_bboxes</strong> – Ground truth boxes with unnormalized
coordinates (x1, y1, x2, y2). Shape (num_gt, 4).</p></li>
<li><p><strong>weight</strong> – loss weight.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>giou_cost value with weight</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.MatchCost.iou">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">iou</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bboxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_bboxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#MatchCost.iou"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.MatchCost.iou" title="Permalink to this definition"></a></dt>
<dd><p>See giou</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.MatchCost.l1">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">l1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#MatchCost.l1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.MatchCost.l1" title="Permalink to this definition"></a></dt>
<dd><p>L1 distance between pred and gt Tensors</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.RoIBox3DAssigner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.target_assigners.</span></span><span class="sig-name descname"><span class="pre">RoIBox3DAssigner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">box_coder</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#RoIBox3DAssigner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.RoIBox3DAssigner" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#cosense3d.modules.plugin.target_assigners.BaseAssigner" title="cosense3d.modules.plugin.target_assigners.BaseAssigner"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseAssigner</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.RoIBox3DAssigner.assign">
<span class="sig-name descname"><span class="pre">assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_boxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt_boxes</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#RoIBox3DAssigner.assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.RoIBox3DAssigner.assign" title="Permalink to this definition"></a></dt>
<dd><p>Assign preds to targets.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.RoIBox3DAssigner.get_predictions">
<span class="sig-name descname"><span class="pre">get_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rcnn_cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rcnn_iou</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rcnn_reg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rois</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#RoIBox3DAssigner.get_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.RoIBox3DAssigner.get_predictions" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.RoadLineAssigner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.target_assigners.</span></span><span class="sig-name descname"><span class="pre">RoadLineAssigner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_neg_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#RoadLineAssigner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.RoadLineAssigner" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#cosense3d.modules.plugin.target_assigners.BaseAssigner" title="cosense3d.modules.plugin.target_assigners.BaseAssigner"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseAssigner</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.RoadLineAssigner.assign">
<span class="sig-name descname"><span class="pre">assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tgt_pts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#RoadLineAssigner.assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.RoadLineAssigner.assign" title="Permalink to this definition"></a></dt>
<dd><p>Assign preds to targets.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.pos_neg_sampling">
<span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.target_assigners.</span></span><span class="sig-name descname"><span class="pre">pos_neg_sampling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_neg_ratio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#pos_neg_sampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.pos_neg_sampling" title="Permalink to this definition"></a></dt>
<dd><p>Downsample negative targets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> – class labels.</p></li>
<li><p><strong>pos_neg_ratio</strong> – ratio = num_neg_samples / num_pos_samples.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>class labels with -1 labels to be ignored during training.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.target_assigners.sample_mining">
<span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.target_assigners.</span></span><span class="sig-name descname"><span class="pre">sample_mining</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dists</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_mining_thr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_sample_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_num_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/target_assigners.html#sample_mining"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.target_assigners.sample_mining" title="Permalink to this definition"></a></dt>
<dd><p>When only limited numbers of negative targets are sampled for training,
and the majority of the negative samples are ignored, then there is a
high probability that hard negative targets are also ignored. This will
weaken the model to learn from these hard negative targets and generate
a lot of false positives.
Therefore, this function mines the samples that have high predictive
scores as training targets. This function should be used after ‘pos_neg_sampling’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scores</strong> – (N1, …Nk) classification scores/confidences that the
sample belong to foreground.</p></li>
<li><p><strong>labels</strong> – (N1…, Nk) class labels, -1 indicates ignore, 0 indicates negative,
positive numbers indicates classes.</p></li>
<li><p><strong>dists</strong> – distances.</p></li>
<li><p><strong>sample_mining_thr</strong> – score threshold for sampling</p></li>
<li><p><strong>max_sample_ratio</strong> – <cite>n_sample</cite> / <cite>n_pos_sample</cite></p></li>
<li><p><strong>max_num_sample</strong> – maximum number of samples.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cosense3d.modules.plugin.transformer">
<span id="cosense3d-modules-plugin-transformer-module"></span><h2>cosense3d.modules.plugin.transformer module<a class="headerlink" href="#module-cosense3d.modules.plugin.transformer" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.FFN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.transformer.</span></span><span class="sig-name descname"><span class="pre">FFN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embed_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feedforward_channels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_fcs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'inplace':</span> <span class="pre">True,</span> <span class="pre">'type':</span> <span class="pre">'ReLU'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_residual</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/transformer.html#FFN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.transformer.FFN" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Implements feed-forward networks (FFNs) with residual connection.</p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.FFN.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/transformer.html#FFN.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.transformer.FFN.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward function for <cite>FFN</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.FFN.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.transformer.FFN.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.MultiHeadAttentionWrapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.transformer.</span></span><span class="sig-name descname"><span class="pre">MultiHeadAttentionWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/transformer.html#MultiHeadAttentionWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.transformer.MultiHeadAttentionWrapper" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MultiheadAttention</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.MultiHeadAttentionWrapper.bias_k">
<span class="sig-name descname"><span class="pre">bias_k</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#cosense3d.modules.plugin.transformer.MultiHeadAttentionWrapper.bias_k" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.MultiHeadAttentionWrapper.bias_v">
<span class="sig-name descname"><span class="pre">bias_v</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#cosense3d.modules.plugin.transformer.MultiHeadAttentionWrapper.bias_v" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.MultiHeadAttentionWrapper.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/transformer.html#MultiHeadAttentionWrapper.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.transformer.MultiHeadAttentionWrapper.forward" title="Permalink to this definition"></a></dt>
<dd><dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>query: Query embeddings of shape <span class="math notranslate nohighlight">\((L, E_q)\)</span> for unbatched input, <span class="math notranslate nohighlight">\((L, N, E_q)\)</span> when <code class="docutils literal notranslate"><span class="pre">batch_first=False</span></code></dt><dd><p>or <span class="math notranslate nohighlight">\((N, L, E_q)\)</span> when <code class="docutils literal notranslate"><span class="pre">batch_first=True</span></code>, where <span class="math notranslate nohighlight">\(L\)</span> is the target sequence length,
<span class="math notranslate nohighlight">\(N\)</span> is the batch size, and <span class="math notranslate nohighlight">\(E_q\)</span> is the query embedding dimension <code class="docutils literal notranslate"><span class="pre">embed_dim</span></code>.
Queries are compared against key-value pairs to produce the output.
See “Attention Is All You Need” for more details.</p>
</dd>
<dt>key: Key embeddings of shape <span class="math notranslate nohighlight">\((S, E_k)\)</span> for unbatched input, <span class="math notranslate nohighlight">\((S, N, E_k)\)</span> when <code class="docutils literal notranslate"><span class="pre">batch_first=False</span></code></dt><dd><p>or <span class="math notranslate nohighlight">\((N, S, E_k)\)</span> when <code class="docutils literal notranslate"><span class="pre">batch_first=True</span></code>, where <span class="math notranslate nohighlight">\(S\)</span> is the source sequence length,
<span class="math notranslate nohighlight">\(N\)</span> is the batch size, and <span class="math notranslate nohighlight">\(E_k\)</span> is the key embedding dimension <code class="docutils literal notranslate"><span class="pre">kdim</span></code>.
See “Attention Is All You Need” for more details.</p>
</dd>
<dt>value: Value embeddings of shape <span class="math notranslate nohighlight">\((S, E_v)\)</span> for unbatched input, <span class="math notranslate nohighlight">\((S, N, E_v)\)</span> when</dt><dd><p><code class="docutils literal notranslate"><span class="pre">batch_first=False</span></code> or <span class="math notranslate nohighlight">\((N, S, E_v)\)</span> when <code class="docutils literal notranslate"><span class="pre">batch_first=True</span></code>, where <span class="math notranslate nohighlight">\(S\)</span> is the source
sequence length, <span class="math notranslate nohighlight">\(N\)</span> is the batch size, and <span class="math notranslate nohighlight">\(E_v\)</span> is the value embedding dimension <code class="docutils literal notranslate"><span class="pre">vdim</span></code>.
See “Attention Is All You Need” for more details.</p>
</dd>
<dt>key_padding_mask: If specified, a mask of shape <span class="math notranslate nohighlight">\((N, S)\)</span> indicating which elements within <code class="docutils literal notranslate"><span class="pre">key</span></code></dt><dd><p>to ignore for the purpose of attention (i.e. treat as “padding”). For unbatched <cite>query</cite>, shape should be <span class="math notranslate nohighlight">\((S)\)</span>.
Binary and byte masks are supported.
For a binary mask, a <code class="docutils literal notranslate"><span class="pre">True</span></code> value indicates that the corresponding <code class="docutils literal notranslate"><span class="pre">key</span></code> value will be ignored for
the purpose of attention. For a byte mask, a non-zero value indicates that the corresponding <code class="docutils literal notranslate"><span class="pre">key</span></code>
value will be ignored.</p>
</dd>
<dt>need_weights: If specified, returns <code class="docutils literal notranslate"><span class="pre">attn_output_weights</span></code> in addition to <code class="docutils literal notranslate"><span class="pre">attn_outputs</span></code>.</dt><dd><p>Default: <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
<dt>attn_mask: If specified, a 2D or 3D mask preventing attention to certain positions. Must be of shape</dt><dd><p><span class="math notranslate nohighlight">\((L, S)\)</span> or <span class="math notranslate nohighlight">\((N\cdot\text{num\_heads}, L, S)\)</span>, where <span class="math notranslate nohighlight">\(N\)</span> is the batch size,
<span class="math notranslate nohighlight">\(L\)</span> is the target sequence length, and <span class="math notranslate nohighlight">\(S\)</span> is the source sequence length. A 2D mask will be
broadcasted across the batch while a 3D mask allows for a different mask for each entry in the batch.
Binary, byte, and float masks are supported. For a binary mask, a <code class="docutils literal notranslate"><span class="pre">True</span></code> value indicates that the
corresponding position is not allowed to attend. For a byte mask, a non-zero value indicates that the
corresponding position is not allowed to attend. For a float mask, the mask values will be added to
the attention weight.</p>
</dd>
<dt>average_attn_weights: If true, indicates that the returned <code class="docutils literal notranslate"><span class="pre">attn_weights</span></code> should be averaged across</dt><dd><p>heads. Otherwise, <code class="docutils literal notranslate"><span class="pre">attn_weights</span></code> are provided separately per head. Note that this flag only has an
effect when <code class="docutils literal notranslate"><span class="pre">need_weights=True</span></code>. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code> (i.e. average weights across heads)</p>
</dd>
</dl>
</dd>
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>attn_output</strong> - Attention outputs of shape <span class="math notranslate nohighlight">\((L, E)\)</span> when input is unbatched,
<span class="math notranslate nohighlight">\((L, N, E)\)</span> when <code class="docutils literal notranslate"><span class="pre">batch_first=False</span></code> or <span class="math notranslate nohighlight">\((N, L, E)\)</span> when <code class="docutils literal notranslate"><span class="pre">batch_first=True</span></code>,
where <span class="math notranslate nohighlight">\(L\)</span> is the target sequence length, <span class="math notranslate nohighlight">\(N\)</span> is the batch size, and <span class="math notranslate nohighlight">\(E\)</span> is the
embedding dimension <code class="docutils literal notranslate"><span class="pre">embed_dim</span></code>.</p></li>
<li><p><strong>attn_output_weights</strong> - Only returned when <code class="docutils literal notranslate"><span class="pre">need_weights=True</span></code>. If <code class="docutils literal notranslate"><span class="pre">average_attn_weights=True</span></code>,
returns attention weights averaged across heads of shape <span class="math notranslate nohighlight">\((L, S)\)</span> when input is unbatched or
<span class="math notranslate nohighlight">\((N, L, S)\)</span>, where <span class="math notranslate nohighlight">\(N\)</span> is the batch size, <span class="math notranslate nohighlight">\(L\)</span> is the target sequence length, and
<span class="math notranslate nohighlight">\(S\)</span> is the source sequence length. If <code class="docutils literal notranslate"><span class="pre">average_weights=False</span></code>, returns attention weights per
head of shape <span class="math notranslate nohighlight">\((\text{num\_heads}, L, S)\)</span> when input is unbatched or <span class="math notranslate nohighlight">\((N, \text{num\_heads}, L, S)\)</span>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><cite>batch_first</cite> argument is ignored for unbatched inputs.</p>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.MultiHeadAttentionWrapper.forward_fp16">
<span class="sig-name descname"><span class="pre">forward_fp16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/transformer.html#MultiHeadAttentionWrapper.forward_fp16"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.transformer.MultiHeadAttentionWrapper.forward_fp16" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.MultiHeadAttentionWrapper.forward_fp32">
<span class="sig-name descname"><span class="pre">forward_fp32</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/transformer.html#MultiHeadAttentionWrapper.forward_fp32"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.transformer.MultiHeadAttentionWrapper.forward_fp32" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.MultiheadAttention">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.transformer.</span></span><span class="sig-name descname"><span class="pre">MultiheadAttention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embed_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_first</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_attn_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp16</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/transformer.html#MultiheadAttention"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.transformer.MultiheadAttention" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A wrapper for <code class="docutils literal notranslate"><span class="pre">torch.nn.MultiheadAttention</span></code>.
This module implements MultiheadAttention with identity connection,
and positional encoding  is also passed as input.</p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.MultiheadAttention.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">identity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_padding_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/transformer.html#MultiheadAttention.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.transformer.MultiheadAttention.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward function for <cite>MultiheadAttention</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> – The input query with shape [num_queries, bs, embed_dims] if self.batch_first is False,
else [bs, num_queries embed_dims].</p></li>
<li><p><strong>key</strong> – The key tensor with shape [num_keys, bs, embed_dims] if self.batch_first is False,
else [bs, num_keys, embed_dims]. If None, the <code class="docutils literal notranslate"><span class="pre">query</span></code> will be used. Defaults to None.</p></li>
<li><p><strong>value</strong> – The value tensor with same shape as <cite>key</cite>. Same in <cite>nn.MultiheadAttention.forward</cite>.
Defaults to None. If None, the <cite>key</cite> will be used.</p></li>
<li><p><strong>identity</strong> – This tensor, with the same shape as x, will be used for the identity link.
If None, <cite>x</cite> will be used. Defaults to None.</p></li>
<li><p><strong>query_pos</strong> – The positional encoding for query, with the same shape as <cite>x</cite>.
If not None, it will be added to <cite>x</cite> before forward function. Defaults to None.</p></li>
<li><p><strong>key_pos</strong> – The positional encoding for <cite>key</cite>, with the same shape as <cite>key</cite>.
Defaults to None. If not None, it will be added to <cite>key</cite> before <cite>query_pos</cite> has the same shape as <cite>key</cite>,
then <cite>query_pos</cite> will be used for <cite>key_pos</cite>. Defaults to None.</p></li>
<li><p><strong>attn_mask</strong> – ByteTensor mask with shape [num_queries, num_keys].
Same in <cite>nn.MultiheadAttention.forward</cite>. Defaults to None.</p></li>
<li><p><strong>key_padding_mask</strong> – ByteTensor with shape [bs, num_keys]. Defaults to None.</p></li>
<li><p><strong>kwargs</strong> – allow passing a more general data flow when combining with other operations in <cite>transformerlayer</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>forwarded results with shape [num_queries, bs, embed_dims] if self.batch_first is False,
else[bs, num_queries embed_dims].</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.MultiheadAttention.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.transformer.MultiheadAttention.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.MultiheadFlashAttention">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.transformer.</span></span><span class="sig-name descname"><span class="pre">MultiheadFlashAttention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embed_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_drop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_drop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_first</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_attn_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/transformer.html#MultiheadFlashAttention"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.transformer.MultiheadFlashAttention" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A wrapper for <code class="docutils literal notranslate"><span class="pre">torch.nn.MultiheadAttention</span></code>.
This module implements MultiheadAttention with identity connection,
and positional encoding  is also passed as input.</p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.MultiheadFlashAttention.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">identity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_padding_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/transformer.html#MultiheadFlashAttention.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.transformer.MultiheadFlashAttention.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward function for <cite>MultiheadAttention</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> – The input query with shape [num_queries, bs, embed_dims] if self.batch_first is False,
else [bs, num_queries embed_dims].</p></li>
<li><p><strong>key</strong> – The key tensor with shape [num_keys, bs, embed_dims] if self.batch_first is False, else
[bs, num_keys, embed_dims]. If None, the <code class="docutils literal notranslate"><span class="pre">query</span></code> will be used. Defaults to None.</p></li>
<li><p><strong>value</strong> – The value tensor with same shape as <cite>key</cite>. Same in <cite>nn.MultiheadAttention.forward</cite>.
Defaults to None. If None, the <cite>key</cite> will be used.</p></li>
<li><p><strong>identity</strong> – This tensor, with the same shape as x, will be used for the identity link.
If None, <cite>x</cite> will be used. Defaults to None.</p></li>
<li><p><strong>query_pos</strong> – The positional encoding for query, with the same shape as <cite>x</cite>. If not None, it will
be added to <cite>x</cite> before forward function. Defaults to None.</p></li>
<li><p><strong>key_pos</strong> – The positional encoding for <cite>key</cite>, with the same shape as <cite>key</cite>. Defaults to None.
If not None, it will be added to <cite>key</cite> before forward function. If None, and <cite>query_pos</cite> has the same
shape as <cite>key</cite>, then <cite>query_pos</cite> will be used for <cite>key_pos</cite>. Defaults to None.</p></li>
<li><p><strong>attn_mask</strong> – ByteTensor mask with shape [num_queries, num_keys].
Same in <cite>nn.MultiheadAttention.forward</cite>. Defaults to None.</p></li>
<li><p><strong>key_padding_mask</strong> – ByteTensor with shape [bs, num_keys]. Defaults to None.</p></li>
<li><p><strong>kwargs</strong> – allow passing a more general data flow when combining with
other operations in <cite>transformerlayer</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>forwarded results with shape [num_queries, bs, embed_dims] if self.batch_first is False, else
[bs, num_queries embed_dims].</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.MultiheadFlashAttention.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.transformer.MultiheadFlashAttention.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.PETRTemporalTransformer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.transformer.</span></span><span class="sig-name descname"><span class="pre">PETRTemporalTransformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">encoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/transformer.html#PETRTemporalTransformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.transformer.PETRTemporalTransformer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Implements the DETR transformer.
Following the official DETR implementation, this module copy-paste
from torch.nn.Transformer with modifications:
* positional encodings are passed in MultiheadAttention
* extra LN at the end of encoder is removed
* decoder returns a stack of activations from all decoding layers
See <a class="reference external" href="https://arxiv.org/pdf/2005.12872">paper: End-to-End Object Detection with Transformers</a> for details.</p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.PETRTemporalTransformer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">memory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tgt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_embed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_masks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg_branch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/transformer.html#PETRTemporalTransformer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.transformer.PETRTemporalTransformer.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward function for <cite>Transformer</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.PETRTemporalTransformer.init_weights">
<span class="sig-name descname"><span class="pre">init_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/transformer.html#PETRTemporalTransformer.init_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.transformer.PETRTemporalTransformer.init_weights" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.PETRTemporalTransformer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.transformer.PETRTemporalTransformer.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.PETRTransformer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.transformer.</span></span><span class="sig-name descname"><span class="pre">PETRTransformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">encoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/transformer.html#PETRTransformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.transformer.PETRTransformer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Implements the DETR transformer.
Following the official DETR implementation, this module copy-paste
from torch.nn.Transformer with modifications:
* positional encodings are passed in MultiheadAttention
* extra LN at the end of encoder is removed
* decoder returns a stack of activations from all decoding layers
See <a class="reference external" href="https://arxiv.org/pdf/2005.12872">paper: End-to-End Object Detection with Transformers</a> for details.</p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.PETRTransformer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">memory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tgt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_embed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_masks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/transformer.html#PETRTransformer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.transformer.PETRTransformer.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward function for <cite>Transformer</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.PETRTransformer.init_weights">
<span class="sig-name descname"><span class="pre">init_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/transformer.html#PETRTransformer.init_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.transformer.PETRTransformer.init_weights" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.PETRTransformer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.transformer.PETRTransformer.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.TransformerDecoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.transformer.</span></span><span class="sig-name descname"><span class="pre">TransformerDecoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">post_norm_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'type':</span> <span class="pre">'LN'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_intermediate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/transformer.html#TransformerDecoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.transformer.TransformerDecoder" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#cosense3d.modules.plugin.transformer.TransformerLayerSequence" title="cosense3d.modules.plugin.transformer.TransformerLayerSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">TransformerLayerSequence</span></code></a></p>
<p>Implements the decoder in DETR transformer.</p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.TransformerDecoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/transformer.html#TransformerDecoder.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.transformer.TransformerDecoder.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward function for <cite>TransformerDecoder</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>query</strong> – (Tensor) Input query with shape <cite>(num_query, bs, embed_dims)</cite>.</p>
</dd>
<dt class="field-even">Return:Tensor<span class="colon">:</span></dt>
<dd class="field-even"><p>Results with shape [1, num_query, bs, embed_dims] when
return_intermediate is <cite>False</cite>, otherwise it has shape [num_layers, num_query, bs, embed_dims].</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.TransformerDecoder.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.transformer.TransformerDecoder.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.TransformerDecoderLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.transformer.</span></span><span class="sig-name descname"><span class="pre">TransformerDecoderLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attn_cfgs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffn_cfgs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">operation_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_cfg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'type':</span> <span class="pre">'LN'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_cp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/transformer.html#TransformerDecoderLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.transformer.TransformerDecoderLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.TransformerDecoderLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_masks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_key_padding_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_padding_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/transformer.html#TransformerDecoderLayer.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.transformer.TransformerDecoderLayer.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward function for <cite>TransformerCoder</cite>.
:returns: Tensor: forwarded results with shape [num_query, bs, embed_dims].</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.TransformerDecoderLayer.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.transformer.TransformerDecoderLayer.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.TransformerLayerSequence">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.transformer.</span></span><span class="sig-name descname"><span class="pre">TransformerLayerSequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transformerlayers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/transformer.html#TransformerLayerSequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.transformer.TransformerLayerSequence" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Base class for TransformerEncoder and TransformerDecoder in vision
transformer.</p>
<p>As base-class of Encoder and Decoder in vision transformer.
Support customization such as specifying different kind
of <cite>transformer_layer</cite> in <cite>transformer_coder</cite>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.TransformerLayerSequence.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_masks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_key_padding_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_padding_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/transformer.html#TransformerLayerSequence.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.transformer.TransformerLayerSequence.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward function for <cite>TransformerCoder</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> – (Tensor) Input query with shape <cite>(num_queries, bs, embed_dims)</cite>.</p></li>
<li><p><strong>key</strong> – (Tensor) The key tensor with shape <cite>(num_keys, bs, embed_dims)</cite>.</p></li>
<li><p><strong>value</strong> – (Tensor) The value tensor with shape <cite>(num_keys, bs, embed_dims)</cite>.</p></li>
<li><p><strong>query_pos</strong> – (Tensor) The positional encoding for <cite>query</cite>. Default: None.</p></li>
<li><p><strong>key_pos</strong> – (Tensor) The positional encoding for <cite>key</cite>. Default: None.</p></li>
<li><p><strong>attn_masks</strong> – (List[Tensor], optional) Each element is 2D Tensor which is
used in calculation of corresponding attention in operation_order. Default: None.</p></li>
<li><p><strong>query_key_padding_mask</strong> – (Tensor) ByteTensor for <cite>query</cite>, with shape [bs, num_queries].
Only used in self-attention Default: None.</p></li>
<li><p><strong>key_padding_mask</strong> – (Tensor) ByteTensor for <cite>query</cite>, with shape [bs, num_keys]. Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>results with shape [num_queries, bs, embed_dims].</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.TransformerLayerSequence.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.transformer.TransformerLayerSequence.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.transformer.build_module">
<span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.transformer.</span></span><span class="sig-name descname"><span class="pre">build_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/transformer.html#build_module"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.transformer.build_module" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-cosense3d.modules.plugin.voxel_encoder">
<span id="cosense3d-modules-plugin-voxel-encoder-module"></span><h2>cosense3d.modules.plugin.voxel_encoder module<a class="headerlink" href="#module-cosense3d.modules.plugin.voxel_encoder" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.voxel_encoder.MeanVFE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.voxel_encoder.</span></span><span class="sig-name descname"><span class="pre">MeanVFE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_point_features</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/voxel_encoder.html#MeanVFE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.voxel_encoder.MeanVFE" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.voxel_encoder.MeanVFE.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voxel_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_num_points</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/voxel_encoder.html#MeanVFE.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.voxel_encoder.MeanVFE.forward" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Args:</dt><dd><p>voxels: (num_voxels, max_points_per_voxel, C)
voxel_num_points: optional (num_voxels)</p>
</dd>
<dt>Returns:</dt><dd><p>vfe_features: (num_voxels, C)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.voxel_encoder.MeanVFE.get_output_feature_dim">
<span class="sig-name descname"><span class="pre">get_output_feature_dim</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/voxel_encoder.html#MeanVFE.get_output_feature_dim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.voxel_encoder.MeanVFE.get_output_feature_dim" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.voxel_encoder.MeanVFE.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.voxel_encoder.MeanVFE.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-cosense3d.modules.plugin.voxel_generator">
<span id="cosense3d-modules-plugin-voxel-generator-module"></span><h2>cosense3d.modules.plugin.voxel_generator module<a class="headerlink" href="#module-cosense3d.modules.plugin.voxel_generator" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.voxel_generator.VoxelGenerator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.voxel_generator.</span></span><span class="sig-name descname"><span class="pre">VoxelGenerator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voxel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lidar_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_points_per_voxel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">empty_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'train'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/voxel_generator.html#VoxelGenerator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.voxel_generator.VoxelGenerator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

</section>
<section id="module-cosense3d.modules.plugin.voxnet_utils">
<span id="cosense3d-modules-plugin-voxnet-utils-module"></span><h2>cosense3d.modules.plugin.voxnet_utils module<a class="headerlink" href="#module-cosense3d.modules.plugin.voxnet_utils" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.voxnet_utils.CML">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.voxnet_utils.</span></span><span class="sig-name descname"><span class="pre">CML</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/voxnet_utils.html#CML"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.voxnet_utils.CML" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.voxnet_utils.CML.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/voxnet_utils.html#CML.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.voxnet_utils.CML.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.voxnet_utils.CML.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.voxnet_utils.CML.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.voxnet_utils.CMLSparse">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.voxnet_utils.</span></span><span class="sig-name descname"><span class="pre">CMLSparse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/voxnet_utils.html#CMLSparse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.voxnet_utils.CMLSparse" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.voxnet_utils.CMLSparse.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/voxnet_utils.html#CMLSparse.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.voxnet_utils.CMLSparse.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.voxnet_utils.CMLSparse.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.voxnet_utils.CMLSparse.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.voxnet_utils.Conv3d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.voxnet_utils.</span></span><span class="sig-name descname"><span class="pre">Conv3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/voxnet_utils.html#Conv3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.voxnet_utils.Conv3d" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.voxnet_utils.Conv3d.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/voxnet_utils.html#Conv3d.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.voxnet_utils.Conv3d.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.voxnet_utils.Conv3d.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.voxnet_utils.Conv3d.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-cosense3d.modules.plugin.vsa">
<span id="cosense3d-modules-plugin-vsa-module"></span><h2>cosense3d.modules.plugin.vsa module<a class="headerlink" href="#module-cosense3d.modules.plugin.vsa" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.vsa.VoxelSetAbstraction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.vsa.</span></span><span class="sig-name descname"><span class="pre">VoxelSetAbstraction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voxel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_cloud_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_keypoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4096</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_out_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'raw_points'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bev_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bev_stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rawpoint_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enlarge_selection_boxes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sa_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_selected_kpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/vsa.html#VoxelSetAbstraction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.vsa.VoxelSetAbstraction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.vsa.VoxelSetAbstraction.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">det_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bev_feat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_feat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/vsa.html#VoxelSetAbstraction.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.vsa.VoxelSetAbstraction.forward" title="Permalink to this definition"></a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.vsa.VoxelSetAbstraction.get_sampled_points">
<span class="sig-name descname"><span class="pre">get_sampled_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_coords</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/vsa.html#VoxelSetAbstraction.get_sampled_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.vsa.VoxelSetAbstraction.get_sampled_points" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.vsa.VoxelSetAbstraction.interpolate_from_bev_features">
<span class="sig-name descname"><span class="pre">interpolate_from_bev_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keypoints_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bev_features</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/vsa.html#VoxelSetAbstraction.interpolate_from_bev_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.vsa.VoxelSetAbstraction.interpolate_from_bev_features" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.vsa.VoxelSetAbstraction.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#cosense3d.modules.plugin.vsa.VoxelSetAbstraction.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.vsa.bilinear_interpolate_torch">
<span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.vsa.</span></span><span class="sig-name descname"><span class="pre">bilinear_interpolate_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin/vsa.html#bilinear_interpolate_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.vsa.bilinear_interpolate_torch" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Args:</dt><dd><p>im: (H, W, C) [y, x]
x: (N)
y: (N)</p>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

</section>
<section id="module-cosense3d.modules.plugin">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-cosense3d.modules.plugin" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.build_plugin_layer">
<span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.</span></span><span class="sig-name descname"><span class="pre">build_plugin_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">postfix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Module</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/cosense3d/modules/plugin.html#build_plugin_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.build_plugin_layer" title="Permalink to this definition"></a></dt>
<dd><p>Build plugin layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> – <p>cfg should contain:</p>
<ul>
<li><p>type (str): identify plugin layer type.</p></li>
<li><p>layer args: args needed to instantiate a plugin layer.</p></li>
</ul>
</p></li>
<li><p><strong>postfix</strong> – appended into norm abbreviation to
create named layer. Default: ‘’.</p></li>
<li><p><strong>kwargs</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The first one is the concatenation of
abbreviation and postfix. The second is the created plugin layer.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.build_plugin_module">
<span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.</span></span><span class="sig-name descname"><span class="pre">build_plugin_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cosense3d/modules/plugin.html#build_plugin_module"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.build_plugin_module" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cosense3d.modules.plugin.infer_abbr">
<span class="sig-prename descclassname"><span class="pre">cosense3d.modules.plugin.</span></span><span class="sig-name descname"><span class="pre">infer_abbr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">class_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">type</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/cosense3d/modules/plugin.html#infer_abbr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cosense3d.modules.plugin.infer_abbr" title="Permalink to this definition"></a></dt>
<dd><p>Infer abbreviation from the class name.</p>
<p>This method will infer the abbreviation to map class types to
abbreviations.</p>
<p>Rule 1: If the class has the property “abbr”, return the property.
Rule 2: Otherwise, the abbreviation falls back to snake case of class
name, e.g. the abbreviation of <code class="docutils literal notranslate"><span class="pre">FancyBlock</span></code> will be <code class="docutils literal notranslate"><span class="pre">fancy_block</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>class_type</strong> – The norm layer type.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The inferred abbreviation.</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="cosense3d.modules.necks.html" class="btn btn-neutral float-left" title="cosense3d.modules.necks package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cosense3d.modules.projection.html" class="btn btn-neutral float-right" title="cosense3d.modules.projection package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Yunshuang Yuan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>